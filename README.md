# Multilingual Word Translation Instagram Post Generator

A React + TypeScript app that generates square translation posts (English, Spanish, Catalan), previews them using Canvas in-memory, uploads to ImgBB, and publishes to Instagram.

## Tech Stack

- React + TypeScript
- Tailwind CSS
- shadcn/ui-style components
- Canvas API
- Axios
- Sonner (toast notifications)

## Project Structure

- `src/services/imageService.ts` - ImgBB upload logic
- `src/services/instagramService.ts` - Instagram API via CORS proxy
- `src/services/translationService.ts` - random translation data
- `src/utils/canvasUtils.ts` - Canvas image composition
- `src/pages/Index.tsx` - main UI page

## Local Run

1. Install dependencies:

```bash
npm install
```

2. Start dev server:

```bash
npm run dev
```

3. Open app URL from Vite output.

## Cloud-Ready Checklist

- Supabase schema is versioned in `supabase/migrations/20260225_create_post_logs.sql`.
- Frontend runtime config is env-driven (`.env.example`).
- Local secret files are git-ignored (`.env.local`, `.env.*`).
- Vercel deployment config is included (`vercel.json`).

## Runtime Credentials (Security)

- Instagram access token and ImgBB API key are entered via password inputs.
- Credentials are kept in component state only.
- No `localStorage` persistence.
- No hardcoded API keys.

## Instagram + ImgBB Flow

1. Canvas generates JPEG (`quality: 0.9`) in-memory from:
- Pexels background image
- Black overlay: `rgba(0, 0, 0, 0.4)`
- Centered white text, bold Inter 48px, line-height 60

2. Base64 JPEG is uploaded to ImgBB.
3. Returned public URL is sent to Instagram:
- `POST /me/media`
- `POST /me/media_publish`

All Instagram requests are proxied through:

- `https://cors-anywhere.herokuapp.com/`

## Step-by-Step Connectivity Guide (Business Instagram + Supabase + Hugging Face)

### 1. Instagram Business Setup

1. Create/verify a Meta app in Meta for Developers.
2. Convert Instagram account to Professional (Business or Creator).
3. Link Instagram account to a Facebook Page.
4. Add required products/permissions in Meta app.
5. Generate long-lived user token with publish permissions.
6. Test `me/media` and `me/media_publish` with a known image URL.

Important: In production, Instagram publishing is generally done with Instagram Graph API permissions. If `graph.instagram.com` token scope is limited in your app mode, route through Graph API server-side using Facebook login and proper scopes.

### 2. Supabase Setup

1. Create Supabase project.
2. In SQL editor, create a table for post logs:

```sql
create table if not exists post_logs (
  id bigint generated by default as identity primary key,
  created_at timestamptz default now() not null,
  en_word text not null,
  es_word text not null,
  ca_word text not null,
  caption text not null,
  image_url text,
  instagram_media_id text,
  status text not null,
  error_message text
);
```

3. Enable Row Level Security and add policies for your app roles.
4. Keep service-role keys server-side only (Edge Function or backend).

### 3. Hugging Face Setup (Optional: AI-generated phrases)

1. Create Hugging Face token with inference access.
2. Choose a multilingual model (translation or instruction model).
3. Build a server endpoint (Supabase Edge Function) that:
- receives source word
- calls Hugging Face API
- returns generated EN/ES/CA phrases
4. In frontend, call your server endpoint instead of calling Hugging Face directly.

### 4. Recommended Production Architecture

1. Frontend: generate preview image locally as now.
2. Frontend sends payload to Supabase Edge Function:
- translation content
- generated image base64 (or ImgBB URL if already uploaded)
3. Edge Function handles:
- secure ImgBB upload
- Instagram posting
- logging to `post_logs`
4. Frontend receives status and shows toast.

This keeps long-lived tokens and API keys off the client.

### 5. Deploy + Connect

1. Push code to GitHub.
2. Deploy frontend to Vercel or Netlify.
3. Configure allowed origins and callback URLs in Meta app.
4. Deploy Supabase Edge Functions.
5. Add smoke test flow:
- generate post
- publish test media
- verify database log row created.

## Notes

- CORS proxy public instances are useful for development but not reliable for production.
- For production use, prefer your own proxy/server (Supabase Edge Function).
- Rotate any secret key that was ever placed in local files or chat history.
